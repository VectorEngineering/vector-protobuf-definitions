import { Hono } from "hono";
import { cors } from "hono/cors";
import { {{basename openApiSpec.info.title}}Router } from "./route";
import type { Env } from "./types";

const app = new Hono<{
  Bindings: Env;
}>();

// CORS middleware
app.use("*", cors({
  origin: "*",
  allowMethods: [{{#each openApiSpec.paths}}{{#with this}}{{#if get}}"GET",{{/if}}{{#if post}}"POST",{{/if}}{{#if put}}"PUT",{{/if}}{{#if delete}}"DELETE",{{/if}}{{/with}}{{/each}}"OPTIONS"],
  allowHeaders: ["Content-Type", "Authorization"],
  exposeHeaders: ["Content-Length", "X-Request-Id"],
  maxAge: 86400,
}));

// API routes
app.route("/api", {{basename openApiSpec.info.title}}Router);

export default app; 